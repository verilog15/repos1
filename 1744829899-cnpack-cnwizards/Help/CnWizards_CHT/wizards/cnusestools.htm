<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>引用單元工具</title>
<meta http-equiv="Content-Type" content="text/html; charset=big5">
<link rel="stylesheet" href="../css/style.css" type="text/css">
</head>

<body>
<table width="100%" border="0" cellpadding="4" id="table1">
  <tr>
    <td class="head" height="16">引用單元工具</td>
  </tr>
  <tr>
    <td bgcolor="#FF9900" height="6"></td>
  </tr>
  <tr>
    <td height=6></td>
  </tr>
</table>
<p class="title">引用單元清理</p>
<p class="text" align="left">該功能用於清理單元中不需要的 uses 引用單元，目前只支持 Delphi。</p>
<p class="text" align="left">當窗體上加入控件時，單元中的 uses 部分會自動加入此控件所在的單元名，但控件如果被刪除，其被引用的單元名卻不會自動刪除。本功能能按一定規則搜索當前單元或當前工程、工程組中可能不需要的單元引用，並列出以供清理。</p>
<p class="text" align="left">本功能執行後界面如圖：</p>
<p class="text" align="center">
  <img src="usescleaner.png"> </p>
<p class="text" align="left">引用單元清理的設置如下：</p>
<ul>
  <li>
<p class="text" align="left"><b>當前編輯的單元</b>：搜索範圍為當前單元。</p>
  </li>
	<li>
<p class="text" align="left"><b>當前工程組中打開的單元</b>：搜索範圍為當前工程組中所有打開的單元。</p>
  </li>
	<li>
<p class="text" align="left"><b>當前工程中的所有單元</b>：搜索範圍為當前工程中的所有單元。</p>
  </li>
	<li>
<p class="text" align="left"><b>當前工程組中的所有單元</b>：搜索範圍為當前工程組中的所有單元。</p>
  </li>
  <li>
<p class="text" align="left"><b>處理間接引用到的單元</b>：勾選此選項時，被間接引用到的源文件單元也會一併處理到，不局限於工程或工程組中的文件。</p>
  </li>
	<li>
<p class="text" align="left"><b>忽略包含初始化節的引用單元</b>：是否忽略包含 initialization 部分的引用單元，此類單元包含初始化操作，刪除其引用可能會導致問題。</p>
  </li>
  <li>
<p class="text" align="left"><b>忽略包含 Register 過程的引用單元</b>：是否忽略包含 Register 過程的引用單元，該類單元常包含組件註冊內容。</p>
  </li>
	<li>
<p class="text" align="left"><b>忽略窗體組件間接引用的單元</b>：是否忽略由組件間接引用到的單元。有些單元定義了組件的父類，如果刪除 
IDE 仍會自動添加上去。另外還可能包含工程中其它的窗體單元，這些窗體上的部分組件被當前窗體的組件在屬性中引用。</p>
  </li>
  <li>
<p class="text" align="left"><b>忽略無源碼的引用單元</b>：是否忽略無源碼的被引用單元。</p>
  </li>
  <li>
<p class="text" align="left"><b>自動保存並關閉未打開文件</b>：本功能在處理單元中的引用內容時，默認是將文件在 IDE 中打開並修改，不自動保存關閉，這種模式在工程非常巨大時容易導致資源耗盡而無法處理。勾選此選項後，文件修改後將自動保存並關閉，不可撤消，適合於大工程。</p>
  </li>
  <li>
<p class="text" align="left"><b>強行清理以下單元</b>：強行將以下單元置於結果中可被清理的位置。</p>
  </li>
  <li>
<p class="text" align="left"><b>強行忽略以下引用單元</b>：搜索時忽略以下單元的引用，常用於一些系統單元。</p>
  </li>
  <li>
<p class="text"><b>處理</b>：按照設置的規則進行編譯並搜索，完畢後彈出搜索結果窗體供清理。</p></li>
  <li>
<p class="text"><b>取消</b>：關閉此窗口，不進行任何清理。</p></li>
  <li>
<p class="text"><b>幫助</b>：顯示此幫助信息。</p></li>
</ul>
<p class="text" align="left"></p>
<p class="title">　</p>
<p class="title">清理分析結果</p>
<p class="text" align="left">點擊「處理」按鈕後會自動編譯並分析需要處理的內容，並將搜索所得的結果列出如下圖。其中，勾上的單元表示搜索分析後認為可刪除引用的單元，用戶可以進一步確定其是否可被刪除。未勾上的單元表示此單元引用有效，或已按某種規則忽略。</p>
<p class="text" align="center">　<img src="usescleanerres.png"></p>
<p class="text" align="left">
<ul>
  <li>
<p class="text"><b>清理</b>：刪除列表中勾上的單元引用。</p></li>
	<li>
<p class="text"><b>取消</b>：關閉此窗口，不進行任何清理。</p></li>
  <li>
<p class="text"><b>幫助</b>：顯示此幫助信息。</p></li>
</ul>
<p class="text" align="left"></p>
<p class="title">　</p>
<p class="title">引用單元初始化順序</p>
<p class="text" align="left">本功能能夠分析當前工程中所有 Unit 的初始化順序，並將其列為樹狀顯示，同時可區分單元類型與引用類型等。</p>
<p class="text" align="left">本功能執行後界面如下圖。左邊是初始化樹顯示區域，中間是初始化順序，也即初始化樹的後序深度優先遍歷結果。右邊是顯示過濾設置，以及文件詳細信息。</p>
<p class="text" align="center">　<img src="usesinittree.png"></p>
<p class="text" align="left">
<ul>
  <li>
<p class="text"><b>關閉</b>：關閉此窗口。</p></li>
  <li>
<p class="text"><b>工程</b>：下拉框列表，可在此選擇需要處理的工程，默認為當前工程。</p></li>
	<li>
<p class="text"><b>分析工程</b>：點擊此按鈕將編譯當前工程，如果編譯成功，則分析編譯後的 dcu 文件以生成初始化樹。</p></li>
  <li>
<p class="text"><b>導出</b>：將初始化樹的內容導出成文本文件。</p></li>
	<li>
<p class="text"><b>打開</b>：在 IDE 中打開所選中的源文件。</p></li>
  <li>
<p class="text"><b>在資源管理器中打開</b>：打開資源管理器並定位選中的源文件。</p></li>
  <li>
<p class="text"><b>查找</b>：彈出查找對話框，供在初始化樹中根據文本查找單元節點。</p></li>
  <li>
<p class="text"><b>查找下一個</b>：重複上一次查找。</p></li>
	<li>
<p class="text"><b>幫助</b>：顯示此幫助信息。</p></li>
	<li>
<p class="text"><b>顯示工程搜索路徑中的單元</b>：是否在初始化樹中顯示處於工程搜索路徑中的單元。</p></li>
	<li>
<p class="text"><b>顯示系統搜索路徑中的單元</b>：是否在初始化樹中顯示處於系統搜索路徑中的單元。</p></li>
</ul>
<p class="title">　</p>
<p class="title">根據標識符查找引用單元</p>
<p class="text" align="left">本功能能夠分析系統中所有的 dcu 庫文件、獲取其內部符號表，並允許根據輸入的標識符進行搜索與引用。引用單元時允許選擇添加至 interface 部分還是 implementation 部分。</p>
<p class="text" align="left">本功能執行後界面如下圖。</p>
<p class="text" align="center"><img src="usesfromident.png"></p>
<p class="text" align="left">
<ul>
  <li>
<p class="text"><b>引用所選單元</b>：當前單元引用所選擇的單元。</p></li>
	<li>
<p class="text"><b>打開</b>：搜索並打開選中的單元所對應的源文件。</p></li>
  <li>
<p class="text"><b>複製單元名</b>：複製所選擇的單元名稱到剪貼板。</p></li>
  <li>
<p class="text"><b>按標識符開頭匹配</b>：查找的時候，輸入的字符從標識符的頭部開始匹配，標識符頭部含有輸入字符的才能顯示。</p></li>
  <li>
<p class="text"><b>按標識符的所有位置匹配</b>：查找的時候，輸入的字符匹配標識符的任何部分，標識符含有輸入字符的才能顯示。</p></li>
  <li>
<p class="text"><b>標識符模糊匹配</b>：查找的時候，標識符模糊匹配輸入的字符即能顯示。</p></li>
  <li>
<p class="text"><b>字體</b>：更改列表框字體。</p></li>
  <li>
<p class="text"><b>幫助</b>：顯示此幫助。</p></li>
  <li>
<p class="text"><b>關閉</b>：關閉此窗口。</p></li>
</ul>
<p class="title">　</p>
<p class="title">工程內批量引用</p>
<p class="text" align="left">本功能允許讓用戶輸入一單元名，之後遍歷當前工程中所有單元，在所有單元的 implementation 部分 uses 該指定單元。</p>
<p class="title" align="left">　<p class="title" align="left">相關主題<p class="text" align="left">
<a href="wizards.htm">IDE 專家基本操作</a><p class="text" align="left">
<a href="../options/wizconfig.htm">IDE 專家設置</a><p class="text" align="left">
<a href="../cnpack/index.htm">關於 IDE 專家包</a><p class="text" align="left">　<hr>
<p class="text" align="center"><a href="https://www.cnpack.org">(C)版權所有 2001-2025 CnPack 開發組</a></p>
</body>
</html>